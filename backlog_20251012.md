# HWP Report Generator 개선 프로젝트 백로그

**프로젝트명**: HWP Report Generator V2.0 - 채팅형 UI 및 템플릿 관리 기능 추가
**작성일**: 2025-10-22
**목적**: Jira 백로그 등록용

---

## 📋 프로젝트 개요

### 현재 시스템 분석
- **기술 스택**:
  - Backend: FastAPI (Python 3.12)
  - Frontend: Vanilla JS + HTML/CSS (단순 폼 기반)
  - Database: SQLite
  - AI: Claude API (Anthropic)
- **주요 기능**:
  - 사용자 인증 (로그인/회원가입)
  - 보고서 주제 입력 → Claude AI 콘텐츠 생성 → HWPX 파일 생성
  - 보고서 이력 관리 및 다운로드
- **데이터 모델**:
  - User (사용자)
  - Report (보고서 이력)
  - TokenUsage (토큰 사용량)

### 개선 목표
- Frontend를 React 기반 채팅형 UI로 전면 개편
- 프롬프트 커스터마이징 기능 추가
- 템플릿 관리 기능 추가 (CRUD + 플레이스홀더 관리)
- 웹 검색 기능 연동

### 팀 구성 및 역할
#### 👨‍💻 Backend Developer (1명)
**담당 영역**:
- FastAPI 기반 REST API 개발 및 유지보수
- 데이터베이스 스키마 설계 및 마이그레이션
- Claude API 통합 및 프롬프트 엔지니어링
- HWPX 파일 처리 로직 개선
- 웹 검색 API 통합
- 인증/권한 관리 시스템 유지보수

**주요 작업**:
- 템플릿 관리 CRUD API 개발
- 프롬프트 프리셋 API 개발
- 웹 검색 기능 통합
- 보고서 생성 로직 개선

**기술 스택**:
- Python 3.12, FastAPI, SQLite/PostgreSQL
- Anthropic Claude API
- Google Custom Search API (또는 대안)

---

#### 👩‍💻 Frontend Developer (1명)
**담당 영역**:
- React 기반 SPA 개발
- 채팅형 UI/UX 설계 및 구현
- 사용자 인증 플로우 구현
- 템플릿 관리 UI 개발
- 반응형 디자인 및 접근성

**주요 작업**:
- React 프로젝트 초기 설정
- 채팅 인터페이스 컴포넌트 개발
- 템플릿 관리 페이지 구현
- 프롬프트 설정 UI 개발
- Backend API 연동

**기술 스택**:
- React 18+, TypeScript (선택)
- React Router, Zustand/Redux
- Axios, Material-UI/Tailwind CSS

---

## 🎯 Epic 구조

```
Epic 1: Frontend React 마이그레이션 및 채팅형 UI 구현
  ├─ Story 1.1: React 프로젝트 초기 설정
  ├─ Story 1.2: 채팅형 UI 컴포넌트 개발
  ├─ Story 1.3: 사용자 인증 React 통합
  └─ Story 1.4: 보고서 생성 채팅 플로우 구현

Epic 2: 프롬프트 커스터마이징 기능
  ├─ Story 2.1: 프롬프트 입력 UI 추가
  ├─ Story 2.2: 프롬프트 프리셋 관리 기능
  └─ Story 2.3: Claude API 프롬프트 통합

Epic 3: 템플릿 관리 시스템 (CRUD)
  ├─ Story 3.1: 템플릿 데이터 모델 및 DB 설계
  ├─ Story 3.2: 템플릿 CRUD API 개발
  ├─ Story 3.3: 플레이스홀더 관리 기능
  └─ Story 3.4: 템플릿 관리 UI 구현

Epic 4: 웹 검색 기능 통합
  ├─ Story 4.1: 웹 검색 API 선택 및 연동
  ├─ Story 4.2: 검색 결과 컨텍스트 통합
  └─ Story 4.3: 검색 UI 및 UX 구현
```

---

## 📝 상세 백로그

### Epic 1: Frontend React 마이그레이션 및 채팅형 UI 구현

#### Story 1.1: React 프로젝트 초기 설정
**Story Points**: 5
**Priority**: Highest
**Assignee**: Frontend Developer
**Collaborators**: Backend Developer (CORS 설정 지원)

**Description**:
현재 Vanilla JS 기반 Frontend를 React로 마이그레이션하기 위한 초기 환경 설정

**Acceptance Criteria**:
- [ ] React 18+ 프로젝트 생성 (Vite 또는 CRA 사용)
- [ ] 프로젝트 폴더 구조 설계 (src/components, src/pages, src/services, src/hooks)
- [ ] Axios 또는 Fetch 기반 API 클라이언트 설정
- [ ] React Router 설정 (로그인, 메인, 관리자 페이지 라우팅)
- [ ] 기본 UI 라이브러리 선택 및 설치 (예: Material-UI, Ant Design, Chakra UI)
- [ ] 환경 변수 설정 (.env 파일로 Backend API URL 관리)
- [ ] 기존 Backend와 CORS 설정 확인 및 테스트

**Technical Notes**:
```bash
# 권장 기술 스택
- React 18+
- TypeScript (선택)
- Vite (빠른 개발 서버)
- React Router v6
- Axios
- Zustand 또는 Redux (상태 관리)
- Tailwind CSS 또는 Material-UI (UI 라이브러리)
```

**Dependencies**: None

---

#### Story 1.2: 채팅형 UI 컴포넌트 개발
**Story Points**: 8
**Priority**: High
**Assignee**: Frontend Developer

**Description**:
사용자와 AI가 대화하는 형태의 채팅 UI 컴포넌트 개발

**Acceptance Criteria**:
- [ ] 채팅 메시지 컴포넌트 개발 (사용자 메시지, AI 응답 메시지)
- [ ] 채팅 입력창 컴포넌트 (텍스트 입력, 전송 버튼, 파일 첨부 옵션)
- [ ] 메시지 히스토리 표시 (스크롤 자동 하단 이동)
- [ ] 타이핑 인디케이터 (AI 응답 대기 중 애니메이션)
- [ ] 메시지 타임스탬프 표시
- [ ] 메시지 삭제/수정 기능 (선택)
- [ ] 반응형 디자인 (모바일, 태블릿, 데스크톱)

**Design Reference**:
```
┌─────────────────────────────────┐
│  HWP Report Generator 💬        │
├─────────────────────────────────┤
│                                 │
│  [AI] 안녕하세요! 보고서 주제를 │
│      입력해주세요.               │
│                        09:30    │
│                                 │
│              [User] 2025년 디지털│
│                     뱅킹 트렌드  │
│                        09:31    │
│                                 │
│  [AI] 네, 보고서를 생성하고      │
│      있습니다...                │
│                        09:31    │
│                                 │
├─────────────────────────────────┤
│  메시지 입력...         [📎][전송]│
└─────────────────────────────────┘
```

**Technical Notes**:
- react-chatbot-kit 또는 직접 구현
- 상태 관리: 메시지 배열 (id, role, content, timestamp)
- WebSocket 고려 (실시간 스트리밍 응답, 추후 구현)

**Dependencies**: Story 1.1

---

#### Story 1.3: 사용자 인증 React 통합
**Story Points**: 5
**Priority**: High
**Assignee**: Frontend Developer

**Description**:
기존 Backend 인증 시스템과 React Frontend 통합

**Acceptance Criteria**:
- [ ] 로그인 페이지 React 컴포넌트 개발
- [ ] 회원가입 페이지 React 컴포넌트 개발
- [ ] JWT 토큰 저장 및 관리 (LocalStorage 또는 HttpOnly Cookie)
- [ ] Axios Interceptor 설정 (자동 토큰 첨부)
- [ ] 인증 상태 관리 (Zustand/Redux)
- [ ] Protected Route 구현 (미인증 시 로그인 페이지로 리다이렉트)
- [ ] 로그아웃 기능 구현
- [ ] 토큰 만료 처리 (자동 로그아웃 또는 리프레시)

**API Endpoints**:
```
POST /api/auth/login
POST /api/auth/register
POST /api/auth/logout (선택)
GET /api/auth/me (현재 사용자 정보)
```

**Technical Notes**:
- JWT 토큰을 Authorization Header에 Bearer 형식으로 전송
- 기존 Backend의 `/api/auth` 라우터 활용

**Dependencies**: Story 1.1

---

#### Story 1.4: 보고서 생성 채팅 플로우 구현
**Story Points**: 8
**Priority**: High
**Assignee**: Frontend Developer
**Collaborators**: Backend Developer (API 연동 지원)

**Description**:
채팅 UI를 통해 보고서를 생성하는 사용자 플로우 구현

**Acceptance Criteria**:
- [ ] 사용자가 주제를 입력하면 AI가 응답하는 플로우
- [ ] 보고서 생성 요청 시 로딩 상태 표시
- [ ] 생성된 보고서 다운로드 링크 표시 (채팅 메시지 내)
- [ ] 보고서 생성 실패 시 에러 메시지 표시
- [ ] 보고서 생성 히스토리를 채팅 메시지로 표시
- [ ] 다운로드 버튼 클릭 시 파일 다운로드

**User Flow**:
```
1. User: "2025년 디지털 뱅킹 트렌드 보고서 작성해줘"
2. AI: "보고서를 생성하고 있습니다... (로딩)"
3. AI: "보고서가 완성되었습니다! [다운로드]"
4. User clicks [다운로드] → HWPX 파일 다운로드
```

**API Integration**:
```
POST /api/reports/generate
GET /api/reports/download/{report_id}
GET /api/reports/my-reports
```

**Technical Notes**:
- 보고서 생성 API 호출 후 응답에서 file_path, filename 수신
- 다운로드 링크 생성: `/api/reports/download/{report_id}`

**Dependencies**: Story 1.2, Story 1.3

---

### Epic 2: 프롬프트 커스터마이징 기능

#### Story 2.1: 프롬프트 입력 UI 추가
**Story Points**: 5
**Priority**: Medium
**Assignee**: Frontend Developer

**Description**:
사용자가 보고서 생성 시 사용할 프롬프트를 직접 입력하거나 수정할 수 있는 UI 추가

**Acceptance Criteria**:
- [ ] 채팅 입력창 옆에 "프롬프트 설정" 버튼 추가
- [ ] 프롬프트 설정 모달/사이드바 UI 개발
- [ ] 시스템 프롬프트 입력 필드 (Textarea)
- [ ] 사용자 프롬프트 템플릿 입력 필드
- [ ] 기본 프롬프트로 되돌리기 버튼
- [ ] 프롬프트 미리보기 기능
- [ ] 저장 및 적용 버튼

**UI Mockup**:
```
┌─────────────────────────────────┐
│  프롬프트 설정 ⚙️                │
├─────────────────────────────────┤
│  시스템 프롬프트:                │
│  ┌───────────────────────────┐  │
│  │ 당신은 금융 업무 보고서를  │  │
│  │ 작성하는 전문가입니다...   │  │
│  └───────────────────────────┘  │
│                                 │
│  사용자 프롬프트 템플릿:         │
│  ┌───────────────────────────┐  │
│  │ 주제: {topic}              │  │
│  │ 다음 섹션을 포함해주세요:  │  │
│  │ - 배경 및 목적             │  │
│  │ - 주요 내용                │  │
│  └───────────────────────────┘  │
│                                 │
│  [기본값으로] [미리보기] [적용]  │
└─────────────────────────────────┘
```

**Technical Notes**:
- 프롬프트 상태는 Zustand/Redux로 관리
- LocalStorage에 저장하여 재방문 시 복원

**Dependencies**: Story 1.4

---

#### Story 2.2: 프롬프트 프리셋 관리 기능
**Story Points**: 8
**Priority**: Medium
**Assignee**: Backend Developer (API 개발)
**Collaborators**: Frontend Developer (UI 개발)

**Description**:
사용자가 자주 사용하는 프롬프트를 프리셋으로 저장하고 관리하는 기능

**Acceptance Criteria**:

**Backend**:
- [ ] PromptPreset 데이터 모델 생성 (id, user_id, name, system_prompt, user_prompt_template, created_at)
- [ ] 프리셋 CRUD API 개발
  - `POST /api/prompts/presets` (생성)
  - `GET /api/prompts/presets` (목록 조회)
  - `PUT /api/prompts/presets/{id}` (수정)
  - `DELETE /api/prompts/presets/{id}` (삭제)
- [ ] 사용자별 프리셋 격리 (본인 프리셋만 조회/수정/삭제)

**Frontend**:
- [ ] 프리셋 목록 UI (드롭다운 또는 리스트)
- [ ] 프리셋 선택 시 프롬프트 자동 적용
- [ ] 새 프리셋 저장 기능
- [ ] 프리셋 수정/삭제 기능

**Database Schema**:
```sql
CREATE TABLE prompt_presets (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    system_prompt TEXT,
    user_prompt_template TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

**Technical Notes**:
- 프리셋은 사용자별로 관리 (user_id FK)
- 기본 프리셋 1개 제공 (시스템 프리셋)

**Dependencies**: Story 2.1

---

#### Story 2.3: Claude API 프롬프트 통합
**Story Points**: 5
**Priority**: Medium
**Assignee**: Backend Developer

**Description**:
사용자 커스텀 프롬프트를 Claude API 요청에 통합

**Acceptance Criteria**:
- [ ] `/api/reports/generate` API 수정: 요청 Body에 `custom_prompt` 필드 추가 (선택)
- [ ] ClaudeClient 클래스 수정: `generate_report()` 메서드가 커스텀 프롬프트를 받을 수 있도록 수정
- [ ] 커스텀 프롬프트가 없을 경우 기본 프롬프트 사용
- [ ] 프롬프트 변수 치환 (예: `{topic}` → 실제 주제)
- [ ] 프롬프트 검증 (길이 제한, 금지어 필터링 등)

**API Request Example**:
```json
POST /api/reports/generate
{
  "topic": "2025년 디지털 뱅킹 트렌드",
  "custom_prompt": {
    "system_prompt": "당신은 금융 전문가입니다.",
    "user_prompt_template": "주제: {topic}\n다음 섹션을 포함해주세요..."
  }
}
```

**Technical Notes**:
- `utils/claude_client.py`의 `generate_report()` 메서드 수정
- 프롬프트 템플릿 엔진 (Jinja2 또는 str.format() 사용)

**Dependencies**: Story 2.2

---

### Epic 3: 템플릿 관리 시스템 (CRUD)

#### Story 3.1: 템플릿 데이터 모델 및 DB 설계
**Story Points**: 5
**Priority**: High
**Assignee**: Backend Developer

**Description**:
HWPX 템플릿을 데이터베이스에서 관리할 수 있도록 데이터 모델 및 스키마 설계

**Acceptance Criteria**:
- [ ] Template 테이블 설계
  - id, user_id (템플릿 소유자), name, description, file_path, is_public, created_at, updated_at
- [ ] TemplatePlaceholder 테이블 설계
  - id, template_id, placeholder_key, placeholder_name, description, default_value, is_required
- [ ] Pydantic 모델 생성 (Template, TemplatePlaceholder)
- [ ] 데이터베이스 마이그레이션 스크립트 작성

**Database Schema**:
```sql
CREATE TABLE templates (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,  -- NULL이면 시스템 기본 템플릿
    name TEXT NOT NULL,
    description TEXT,
    file_path TEXT NOT NULL,  -- HWPX 파일 경로
    is_public BOOLEAN DEFAULT FALSE,  -- 다른 사용자 사용 가능 여부
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE template_placeholders (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    template_id INTEGER NOT NULL,
    placeholder_key TEXT NOT NULL,  -- 예: TITLE, BACKGROUND, MAIN_CONTENT
    placeholder_name TEXT NOT NULL,  -- 한글명: 제목, 배경 및 목적
    description TEXT,
    default_value TEXT,
    is_required BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (template_id) REFERENCES templates(id) ON DELETE CASCADE
);
```

**Pydantic Models**:
```python
class Template(BaseModel):
    id: Optional[int]
    user_id: Optional[int]
    name: str
    description: Optional[str]
    file_path: str
    is_public: bool = False
    created_at: Optional[datetime]
    updated_at: Optional[datetime]

class TemplatePlaceholder(BaseModel):
    id: Optional[int]
    template_id: int
    placeholder_key: str
    placeholder_name: str
    description: Optional[str]
    default_value: Optional[str]
    is_required: bool = True
    created_at: Optional[datetime]
```

**Dependencies**: None

---

#### Story 3.2: 템플릿 CRUD API 개발
**Story Points**: 8
**Priority**: High
**Assignee**: Backend Developer

**Description**:
템플릿 생성, 조회, 수정, 삭제 API 개발

**Acceptance Criteria**:
- [ ] 템플릿 목록 조회 API (`GET /api/templates`)
  - 본인이 생성한 템플릿 + 공개 템플릿 조회
- [ ] 템플릿 상세 조회 API (`GET /api/templates/{id}`)
  - 플레이스홀더 정보 포함
- [ ] 템플릿 생성 API (`POST /api/templates`)
  - HWPX 파일 업로드 + 메타데이터 저장
- [ ] 템플릿 수정 API (`PUT /api/templates/{id}`)
  - 메타데이터만 수정 (파일은 별도 API)
- [ ] 템플릿 삭제 API (`DELETE /api/templates/{id}`)
  - 본인이 생성한 템플릿만 삭제 가능
- [ ] 템플릿 파일 업로드 API (`POST /api/templates/{id}/upload`)
  - HWPX 파일 교체

**API Endpoints**:
```python
# routers/templates.py
@router.get("/api/templates", response_model=TemplateListResponse)
@router.get("/api/templates/{id}", response_model=TemplateDetailResponse)
@router.post("/api/templates", response_model=TemplateResponse)
@router.put("/api/templates/{id}", response_model=TemplateResponse)
@router.delete("/api/templates/{id}")
@router.post("/api/templates/{id}/upload")
```

**Technical Notes**:
- 파일 업로드는 `UploadFile` 사용
- 템플릿 파일은 `templates/user_{user_id}/` 디렉토리에 저장
- 권한 검증: 본인 템플릿만 수정/삭제 가능 (관리자는 모든 템플릿 접근 가능)

**Dependencies**: Story 3.1

---

#### Story 3.3: 플레이스홀더 관리 기능
**Story Points**: 8
**Priority**: High
**Assignee**: Backend Developer

**Description**:
템플릿의 플레이스홀더를 관리하는 CRUD API 개발

**Acceptance Criteria**:
- [ ] 플레이스홀더 목록 조회 API (`GET /api/templates/{template_id}/placeholders`)
- [ ] 플레이스홀더 추가 API (`POST /api/templates/{template_id}/placeholders`)
- [ ] 플레이스홀더 수정 API (`PUT /api/templates/{template_id}/placeholders/{id}`)
- [ ] 플레이스홀더 삭제 API (`DELETE /api/templates/{template_id}/placeholders/{id}`)
- [ ] 플레이스홀더 자동 감지 기능 (HWPX 파일에서 `{{...}}` 패턴 파싱)
- [ ] 플레이스홀더 검증 (key 중복 방지)

**API Endpoints**:
```python
@router.get("/api/templates/{template_id}/placeholders")
@router.post("/api/templates/{template_id}/placeholders")
@router.put("/api/templates/{template_id}/placeholders/{id}")
@router.delete("/api/templates/{template_id}/placeholders/{id}")
@router.post("/api/templates/{template_id}/detect-placeholders")  # 자동 감지
```

**Placeholder Detection Logic**:
```python
import re

def detect_placeholders(hwpx_file_path):
    """HWPX 파일에서 {{PLACEHOLDER}} 패턴을 추출"""
    # HWPX 파일 압축 해제 → section0.xml 파싱
    # 정규식으로 {{...}} 추출
    pattern = r'\{\{([A-Z_]+)\}\}'
    placeholders = re.findall(pattern, xml_content)
    return list(set(placeholders))  # 중복 제거
```

**Technical Notes**:
- 플레이스홀더 자동 감지는 HWPX 파일 업로드 시 자동 실행 옵션 제공
- 기본 플레이스홀더: TITLE, DATE, BACKGROUND, MAIN_CONTENT, CONCLUSION, SUMMARY

**Dependencies**: Story 3.2

---

#### Story 3.4: 템플릿 관리 UI 구현
**Story Points**: 8
**Priority**: Medium
**Assignee**: Frontend Developer

**Description**:
React에서 템플릿을 관리할 수 있는 UI 구현

**Acceptance Criteria**:
- [ ] 템플릿 목록 페이지 (`/templates`)
  - 본인 템플릿 + 공개 템플릿 표시
  - 템플릿 카드 (이름, 설명, 생성일, 플레이스홀더 개수)
- [ ] 템플릿 상세 페이지 (`/templates/{id}`)
  - 템플릿 정보 표시
  - 플레이스홀더 목록 표시
  - 수정/삭제 버튼
- [ ] 템플릿 생성 페이지 (`/templates/new`)
  - 템플릿 이름, 설명 입력
  - HWPX 파일 업로드
  - 플레이스홀더 자동 감지 또는 수동 추가
- [ ] 템플릿 수정 페이지 (`/templates/{id}/edit`)
- [ ] 플레이스홀더 추가/수정/삭제 UI (모달 또는 인라인 폼)

**UI Mockup (템플릿 목록)**:
```
┌─────────────────────────────────┐
│  템플릿 관리 📄          [+ 새 템플릿] │
├─────────────────────────────────┤
│  ┌───────────────────────────┐  │
│  │ 기본 보고서 템플릿         │  │
│  │ 설명: 금융 업무보고서 템플릿│  │
│  │ 플레이스홀더: 6개          │  │
│  │ 생성일: 2025-10-20         │  │
│  │ [사용] [수정] [삭제]        │  │
│  └───────────────────────────┘  │
│  ┌───────────────────────────┐  │
│  │ 분기 보고서 템플릿         │  │
│  │ ...                        │  │
│  └───────────────────────────┘  │
└─────────────────────────────────┘
```

**Technical Notes**:
- React Router로 템플릿 관련 페이지 라우팅
- 파일 업로드는 `<input type="file" accept=".hwpx" />`
- Drag & Drop 파일 업로드 지원 (선택)

**Dependencies**: Story 3.2, Story 3.3

---

### Epic 4: 웹 검색 기능 통합

#### Story 4.1: 웹 검색 API 선택 및 연동
**Story Points**: 8
**Priority**: Low
**Assignee**: Backend Developer

**Description**:
보고서 생성 시 최신 정보를 검색하여 컨텍스트에 포함할 수 있도록 웹 검색 API 연동

**Acceptance Criteria**:
- [ ] 웹 검색 API 선택 (Google Custom Search, Bing Search, Tavily, SerpAPI 등)
- [ ] API 키 발급 및 `.env` 설정
- [ ] 검색 API 래퍼 함수 작성 (`utils/web_search.py`)
  - `search(query: str, num_results: int = 5) -> List[SearchResult]`
- [ ] 검색 결과를 프롬프트 컨텍스트로 포맷팅하는 함수
- [ ] 검색 기능 on/off 옵션 추가 (보고서 생성 요청 시)

**API Options**:
| API | 장점 | 단점 | 가격 |
|-----|-----|-----|-----|
| Google Custom Search | 정확도 높음 | 하루 100건 무료 제한 | $5/1000 queries |
| Bing Search | MS 통합 | 설정 복잡 | 무료 티어 1000건/월 |
| Tavily | AI 친화적 | 신규 서비스 | $49/월 |
| SerpAPI | 다양한 검색엔진 지원 | 유료 | $50/월 |

**Recommended**: Google Custom Search API (무료 티어로 시작)

**Code Example**:
```python
# utils/web_search.py
import os
import requests
from typing import List, Dict

class WebSearchClient:
    def __init__(self):
        self.api_key = os.getenv("GOOGLE_SEARCH_API_KEY")
        self.search_engine_id = os.getenv("GOOGLE_SEARCH_ENGINE_ID")
        self.base_url = "https://www.googleapis.com/customsearch/v1"

    def search(self, query: str, num_results: int = 5) -> List[Dict]:
        params = {
            "key": self.api_key,
            "cx": self.search_engine_id,
            "q": query,
            "num": num_results
        }
        response = requests.get(self.base_url, params=params)
        response.raise_for_status()

        results = []
        for item in response.json().get("items", []):
            results.append({
                "title": item["title"],
                "link": item["link"],
                "snippet": item["snippet"]
            })
        return results

    def format_for_prompt(self, results: List[Dict]) -> str:
        """검색 결과를 프롬프트 컨텍스트로 포맷팅"""
        context = "## 웹 검색 결과\n\n"
        for i, result in enumerate(results, 1):
            context += f"{i}. **{result['title']}**\n"
            context += f"   {result['snippet']}\n"
            context += f"   출처: {result['link']}\n\n"
        return context
```

**Technical Notes**:
- 검색 쿼리 최적화: 보고서 주제에서 키워드 추출
- 검색 결과 캐싱 (동일 쿼리 재검색 방지)

**Dependencies**: None

---

#### Story 4.2: 검색 결과 컨텍스트 통합
**Story Points**: 5
**Priority**: Low
**Assignee**: Backend Developer

**Description**:
웹 검색 결과를 Claude API 프롬프트에 통합하여 보고서 생성

**Acceptance Criteria**:
- [ ] `/api/reports/generate` API 수정: 요청 Body에 `enable_web_search` 필드 추가
- [ ] `enable_web_search=true`일 때 웹 검색 실행
- [ ] 검색 결과를 프롬프트에 포함하여 Claude API 호출
- [ ] 검색 결과를 보고서 메타데이터에 저장 (선택)
- [ ] 검색 실패 시에도 보고서 생성 계속 진행 (검색 결과 없이)

**Prompt Integration Example**:
```python
# utils/claude_client.py

def generate_report(self, topic: str, web_search_results: Optional[str] = None):
    system_prompt = "당신은 금융 업무 보고서를 작성하는 전문가입니다."

    user_prompt = f"주제: {topic}\n\n"

    if web_search_results:
        user_prompt += web_search_results + "\n\n"

    user_prompt += "위 정보를 참고하여 다음 형식으로 보고서를 작성하세요..."

    # Claude API 호출
    ...
```

**API Request Example**:
```json
POST /api/reports/generate
{
  "topic": "2025년 디지털 뱅킹 트렌드",
  "enable_web_search": true
}
```

**Technical Notes**:
- 검색 결과는 프롬프트 길이 제한 내에서 적절히 요약
- Claude API의 max_tokens를 초과하지 않도록 주의

**Dependencies**: Story 4.1

---

#### Story 4.3: 검색 UI 및 UX 구현
**Story Points**: 5
**Priority**: Low
**Assignee**: Frontend Developer

**Description**:
사용자가 웹 검색 기능을 활성화하고 검색 결과를 확인할 수 있는 UI 구현

**Acceptance Criteria**:
- [ ] 보고서 생성 시 "웹 검색 활성화" 체크박스 추가
- [ ] 검색 중 로딩 표시 ("웹 검색 중...")
- [ ] 검색 결과 미리보기 (채팅 메시지 또는 모달)
- [ ] 검색 결과 출처 링크 표시
- [ ] 검색 결과를 보고서에 포함할지 선택 옵션 (선택)

**UI Mockup**:
```
┌─────────────────────────────────┐
│  보고서 생성 💬                  │
├─────────────────────────────────┤
│  [User] 2025년 디지털 뱅킹 트렌드│
│                                 │
│  [AI] 웹 검색 중... 🔍          │
│                                 │
│  [AI] 검색 결과 (5건)            │
│  ┌───────────────────────────┐  │
│  │ 1. 2025 디지털뱅킹 전망    │  │
│  │    출처: fintech.com      │  │
│  │ 2. 금융권 AI 도입 현황     │  │
│  │    ...                    │  │
│  └───────────────────────────┘  │
│                                 │
│  [AI] 보고서를 생성하고 있습니다│
│                                 │
├─────────────────────────────────┤
│  메시지 입력...                  │
│  ☑ 웹 검색 활성화        [전송] │
└─────────────────────────────────┘
```

**Technical Notes**:
- 검색 결과는 접을 수 있는 아코디언 형태로 표시
- 검색 결과 클릭 시 새 탭에서 링크 열기

**Dependencies**: Story 4.2

---

## 🏗️ 기술적 고려사항

### Frontend (React)
```
hwp-report-frontend/
├── public/
├── src/
│   ├── components/
│   │   ├── Chat/
│   │   │   ├── ChatMessage.tsx
│   │   │   ├── ChatInput.tsx
│   │   │   └── ChatWindow.tsx
│   │   ├── Template/
│   │   │   ├── TemplateList.tsx
│   │   │   ├── TemplateDetail.tsx
│   │   │   └── TemplatePlaceholderManager.tsx
│   │   ├── Prompt/
│   │   │   ├── PromptSettings.tsx
│   │   │   └── PromptPresetSelector.tsx
│   │   └── Auth/
│   │       ├── Login.tsx
│   │       └── Register.tsx
│   ├── pages/
│   │   ├── ChatPage.tsx
│   │   ├── TemplatePage.tsx
│   │   └── AdminPage.tsx
│   ├── services/
│   │   ├── api.ts (Axios 클라이언트)
│   │   ├── authService.ts
│   │   ├── reportService.ts
│   │   └── templateService.ts
│   ├── hooks/
│   │   ├── useAuth.ts
│   │   └── useChat.ts
│   ├── store/
│   │   ├── authStore.ts (Zustand)
│   │   └── chatStore.ts
│   └── App.tsx
└── package.json
```

### Backend (FastAPI)
```
hwp-report-generator/
├── routers/
│   ├── auth.py (기존)
│   ├── reports.py (수정)
│   ├── templates.py (신규)
│   ├── prompts.py (신규)
│   └── admin.py (기존)
├── models/
│   ├── user.py (기존)
│   ├── report.py (기존)
│   ├── template.py (신규)
│   ├── template_placeholder.py (신규)
│   └── prompt_preset.py (신규)
├── database/
│   ├── template_db.py (신규)
│   └── prompt_preset_db.py (신규)
├── utils/
│   ├── claude_client.py (수정)
│   ├── hwp_handler.py (수정)
│   └── web_search.py (신규)
└── main.py (CORS 설정 추가)
```

### 환경 변수 추가
```env
# .env
CLAUDE_API_KEY=sk-...
CLAUDE_MODEL=claude-sonnet-4-5-20250929

# 웹 검색 API
GOOGLE_SEARCH_API_KEY=your_api_key
GOOGLE_SEARCH_ENGINE_ID=your_engine_id

# Frontend URL (CORS)
FRONTEND_URL=http://localhost:3000
```

---

## 📅 개발 일정 (예상)

### Phase 1: Frontend React 마이그레이션 (2-3주)

#### Week 1
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 1.1 | Frontend Dev | React 프로젝트 초기 설정 | 5 |
| 1.2 | Frontend Dev | 채팅형 UI 컴포넌트 개발 시작 | 4 (부분) |
| - | Backend Dev | CORS 설정 및 API 문서 정리 | - |

#### Week 2
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 1.2 | Frontend Dev | 채팅형 UI 컴포넌트 개발 완료 | 4 (부분) |
| 1.3 | Frontend Dev | 사용자 인증 React 통합 | 5 |
| - | Backend Dev | 기존 API 테스트 및 버그 수정 | - |

#### Week 3
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 1.4 | Frontend Dev | 보고서 생성 채팅 플로우 구현 | 8 |
| - | Backend Dev | API 연동 지원 및 테스트 | - |
| - | Both | 통합 테스트 및 버그 수정 | - |

---

### Phase 2: 프롬프트 커스터마이징 (1-2주)

#### Week 4
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 2.1 | Frontend Dev | 프롬프트 입력 UI 추가 | 5 |
| 2.2 | Backend Dev | 프롬프트 프리셋 DB 및 API 개발 | 4 (부분) |

#### Week 5
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 2.2 | Frontend Dev | 프리셋 관리 UI 개발 | 4 (부분) |
| 2.3 | Backend Dev | Claude API 프롬프트 통합 | 5 |
| - | Both | 기능 테스트 및 QA | - |

---

### Phase 3: 템플릿 관리 시스템 (2-3주)

#### Week 5-6
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 3.1 | Backend Dev | 템플릿 데이터 모델 및 DB 설계 | 5 |
| 3.2 | Backend Dev | 템플릿 CRUD API 개발 | 8 |

#### Week 6-7
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 3.3 | Backend Dev | 플레이스홀더 관리 기능 | 8 |
| 3.4 | Frontend Dev | 템플릿 관리 UI 구현 | 8 |
| - | Both | 통합 테스트 | - |

---

### Phase 4: 웹 검색 기능 (1-2주)

#### Week 8
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 4.1 | Backend Dev | 웹 검색 API 선택 및 연동 | 8 |
| 4.2 | Backend Dev | 검색 결과 컨텍스트 통합 | 5 |

#### Week 9
| Story | Assignee | 작업 내용 | Story Points |
|-------|----------|----------|--------------|
| 4.3 | Frontend Dev | 검색 UI 및 UX 구현 | 5 |
| - | Both | 최종 통합 테스트 및 배포 준비 | - |

---

**총 예상 기간**: 8-10주

### 역할별 작업량 요약

#### 👨‍💻 Backend Developer
- **총 Story Points**: 43
- **주요 Phase**: Phase 2, 3, 4
- **핵심 작업**:
  - DB 스키마 설계 및 마이그레이션 (3개 테이블 추가)
  - REST API 개발 (약 20개 엔드포인트)
  - Claude API 및 웹 검색 API 통합
  - HWPX 파일 처리 로직 유지보수

#### 👩‍💻 Frontend Developer
- **총 Story Points**: 46
- **주요 Phase**: Phase 1, 3
- **핵심 작업**:
  - React 프로젝트 마이그레이션
  - 채팅형 UI/UX 개발
  - 템플릿 관리 인터페이스 구현
  - 프롬프트 설정 UI 개발

---

## 🧪 테스트 계획

### Unit Tests
- Backend API 엔드포인트 테스트 (pytest)
- React 컴포넌트 테스트 (Jest + React Testing Library)

### Integration Tests
- Frontend ↔ Backend API 통합 테스트
- 템플릿 생성 → 보고서 생성 E2E 테스트

### User Acceptance Test (UAT)
- 채팅형 UI 사용성 테스트
- 템플릿 관리 기능 테스트
- 프롬프트 커스터마이징 테스트

---

## 📊 우선순위 매트릭스

| Epic | Priority | Business Value | Complexity | 주 담당자 | 권장 순서 |
|------|----------|----------------|------------|----------|---------|
| Epic 1 (React UI) | Highest | High | High | Frontend Dev | 1 |
| Epic 3 (템플릿 관리) | High | High | Medium | Backend Dev | 2 |
| Epic 2 (프롬프트) | Medium | Medium | Low | Both | 3 |
| Epic 4 (웹 검색) | Low | Low | Medium | Backend Dev | 4 |

### 역할별 Epic 담당 분포

#### Backend Developer 주도 Epic
- **Epic 2**: 프롬프트 커스터마이징 (Backend 60% / Frontend 40%)
- **Epic 3**: 템플릿 관리 시스템 (Backend 70% / Frontend 30%)
- **Epic 4**: 웹 검색 기능 (Backend 80% / Frontend 20%)

#### Frontend Developer 주도 Epic
- **Epic 1**: React 마이그레이션 (Frontend 90% / Backend 10%)

#### 협업 포인트
- **Week 3**: 보고서 생성 채팅 플로우 (Frontend + Backend 긴밀한 협업)
- **Week 5**: 프롬프트 프리셋 기능 (Backend API + Frontend UI 동시 개발)
- **Week 7**: 템플릿 관리 통합 테스트 (Both)

---

## 🚀 배포 전략

### Development
- React: `npm run dev` (Vite)
- Backend: `uvicorn main:app --reload`

### Production
- Frontend: Vercel 또는 Netlify
- Backend: Render.com, AWS EC2, 또는 Docker
- Database: SQLite → PostgreSQL 마이그레이션 고려

---

## 📝 추가 개선 사항 (Nice-to-Have)

1. **실시간 스트리밍 응답** (WebSocket)
   - Claude API의 스트리밍 응답을 실시간으로 채팅에 표시

2. **보고서 버전 관리**
   - 동일 주제의 보고서를 여러 버전으로 저장 및 비교

3. **협업 기능**
   - 팀원과 템플릿 공유
   - 보고서 공동 작성

4. **다국어 지원**
   - 영어, 한국어 UI 전환

5. **보고서 미리보기**
   - HWPX 파일을 브라우저에서 미리보기 (어려움: HWPX → HTML/PDF 변환 필요)

---

## 📌 참고 자료

- [FastAPI 공식 문서](https://fastapi.tiangolo.com/)
- [React 공식 문서](https://react.dev/)
- [Claude API 문서](https://docs.anthropic.com/claude/reference/getting-started-with-the-api)
- [Google Custom Search API](https://developers.google.com/custom-search/v1/overview)

---

## ✅ 체크리스트 (착수 전 확인)

### 공통 (Both)
- [ ] Jira 프로젝트 생성 및 Epic/Story 등록
- [ ] Git 브랜치 전략 수립 (feature/epic-1-story-1, develop, main)
- [ ] 개발 환경 공유 문서 작성
- [ ] 주간 미팅 일정 수립 (매주 월요일 오전 10시 권장)
- [ ] 커뮤니케이션 채널 설정 (Slack, Discord 등)
- [ ] 코드 리뷰 프로세스 정의

### Backend Developer
- [ ] FastAPI 개발 환경 설정 확인
- [ ] SQLite → PostgreSQL 마이그레이션 계획 수립
- [ ] Claude API 키 발급 및 테스트
- [ ] Google Custom Search API 키 발급
- [ ] API 문서 자동화 (Swagger/ReDoc) 설정
- [ ] 데이터베이스 마이그레이션 스크립트 준비
- [ ] pytest 테스트 환경 구축
- [ ] CORS 설정 확인 (Frontend URL 화이트리스트)

### Frontend Developer
- [ ] React 프로젝트 생성 (Vite 권장)
- [ ] TypeScript 사용 여부 결정
- [ ] UI 라이브러리 선택 (Material-UI, Ant Design, Chakra UI)
- [ ] 디자인 시스템 정의 (색상, 폰트, 컴포넌트 가이드)
- [ ] 상태 관리 라이브러리 선택 (Zustand 또는 Redux)
- [ ] React Router 설정
- [ ] Axios 클라이언트 설정
- [ ] Jest + React Testing Library 테스트 환경 구축
- [ ] 와이어프레임/프로토타입 준비 (Figma 등)

### 배포 및 DevOps (선택)
- [ ] CI/CD 파이프라인 설정 (GitHub Actions)
- [ ] Frontend 배포 환경 선택 (Vercel, Netlify)
- [ ] Backend 배포 환경 선택 (Render.com, AWS)
- [ ] 환경 변수 관리 (.env.example 작성)
- [ ] Docker 컨테이너화 (선택)

---

## 📞 팀 커뮤니케이션 가이드

### 일일 스탠드업 (Optional)
- **시간**: 매일 오전 10시 (15분)
- **내용**: 어제 한 일, 오늘 할 일, 블로커

### 주간 스프린트 리뷰
- **시간**: 매주 금요일 오후 4시 (1시간)
- **내용**: 완료된 Story 데모, 다음 주 계획

### 블로킹 이슈 처리
- Backend API가 준비되지 않아 Frontend 개발이 막힌 경우:
  - Mock API 또는 JSON Server 사용
  - Backend Developer에게 우선순위 조정 요청
- Frontend UI가 준비되지 않아 Backend 테스트가 어려운 경우:
  - Postman 또는 curl로 API 테스트
  - Swagger UI 활용

### 코드 리뷰 프로세스
1. Feature 브랜치에서 작업
2. PR 생성 (제목: `[Epic-Story] 작업 내용`)
3. 상대방 개발자가 코드 리뷰
4. 승인 후 develop 브랜치 머지
5. 주 단위로 develop → main 머지

---

**문서 버전**: 1.1
**최종 수정일**: 2025-10-22
**작성자**: Claude Code (AI Assistant)
**수정 내역**:
- v1.1 (2025-10-22): 팀 구성 및 역할 추가, 개발 일정 역할별 분담표 추가, 체크리스트 역할별 구분
